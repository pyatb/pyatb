<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BANDUNFOLDING &mdash; PYATB v1.0.0  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FERMI_ENERGY" href="fermi_energy.html" />
    <link rel="prev" title="BAND_STRUCTURE" href="band_structure.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PYATB v1.0.0
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Quick Start</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../run.html">Run</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_files.html">Brief introduction of the input files</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functions</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Functions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="band_structure.html">BAND_STRUCTURE</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">BANDUNFOLDING</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fermi_energy.html">FERMI_ENERGY</a></li>
<li class="toctree-l2"><a class="reference internal" href="fermi_surface.html">FERMI_SURFACE</a></li>
<li class="toctree-l2"><a class="reference internal" href="find_nodes.html">FIND_NODES</a></li>
<li class="toctree-l2"><a class="reference internal" href="pdos.html">PDOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="fat_band.html">FAT_BAND</a></li>
<li class="toctree-l2"><a class="reference internal" href="spin_texture.html">SPIN_TEXTURE</a></li>
<li class="toctree-l2"><a class="reference internal" href="wilson_loop.html">WILSON_LOOP</a></li>
<li class="toctree-l2"><a class="reference internal" href="polarization.html">POLARIZATION</a></li>
<li class="toctree-l2"><a class="reference internal" href="berry_curvature.html">BERRY_CURVATURE</a></li>
<li class="toctree-l2"><a class="reference internal" href="ahc.html">AHC</a></li>
<li class="toctree-l2"><a class="reference internal" href="chern_number.html">CHERN_NUMBER</a></li>
<li class="toctree-l2"><a class="reference internal" href="chirality.html">CHIRALITY</a></li>
<li class="toctree-l2"><a class="reference internal" href="jdos.html">JDOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="optical_conductivity.html">OPTICAL_CONDUCTIVITY</a></li>
<li class="toctree-l2"><a class="reference internal" href="shift_current.html">SHIFT_CURRENT</a></li>
<li class="toctree-l2"><a class="reference internal" href="berry_curvature_dipole.html">BERRY_CURVATURE_DIPOLE</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Keywords</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">Detailed Introduction of the Input Files</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PYATB v1.0.0</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Functions</a></li>
      <li class="breadcrumb-item active">BANDUNFOLDING</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/functions/bandunfolding.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="bandunfolding">
<h1>BANDUNFOLDING<a class="headerlink" href="#bandunfolding" title="Permalink to this heading">¶</a></h1>
<section id="introduction">
<h2>introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>Band unfolding is a method of projecting the wave function of the supercell to the coupled <span class="math notranslate nohighlight">\(\mathbf{k}\)</span> points in the original unit cell to obtain the spectral function.</p>
<p>The relationships between the lattice vectors of the large cell (A) and  primitive cell (a) are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
    A_1 \\
    A_1 \\
    A_3
\end{bmatrix} = 
\begin{bmatrix}
    m_{11} &amp; m_{12} &amp; m_{13} \\
    m_{21} &amp; m_{22} &amp; m_{23} \\
    m_{31} &amp; m_{32} &amp; m_{33} \\
\end{bmatrix}
\begin{bmatrix}
    a_1 \\
    a_2 \\
    a_3
\end{bmatrix}
\end{split}\]</div>
<p>Detailed descriptions can be found in <a class="reference external" href="https://doi.org/10.1016/j.commatsci.2022.111656">First-principles calculations of the surface states of doped and alloyed topological materials via band unfolding method</a>.</p>
</section>
<section id="example">
<h2>example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h2>
<p>Here is an example located in the <code class="docutils literal notranslate"><span class="pre">examples/NV</span></code> folder that showcases how to calculate the spectral function of the nitrogen-vacancy (NV) center in diamond.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Input</span></code> file is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INPUT_PARAMETERS</span>
<span class="p">{</span>
    <span class="n">nspin</span>                           <span class="mi">1</span>   
    <span class="n">package</span>                         <span class="n">ABACUS</span>
    <span class="n">fermi_energy</span>                    <span class="mf">15.46412271260700</span>
    <span class="n">fermi_energy_unit</span>               <span class="n">eV</span>  
    <span class="n">HR_route</span>                        <span class="n">data</span><span class="o">-</span><span class="n">HR</span><span class="o">-</span><span class="n">sparse_SPIN0</span><span class="o">.</span><span class="n">csr</span>
    <span class="n">SR_route</span>                        <span class="n">data</span><span class="o">-</span><span class="n">SR</span><span class="o">-</span><span class="n">sparse_SPIN0</span><span class="o">.</span><span class="n">csr</span>
    <span class="n">rR_route</span>                        <span class="n">data</span><span class="o">-</span><span class="n">rR</span><span class="o">-</span><span class="n">sparse</span><span class="o">.</span><span class="n">csr</span>
    <span class="n">HR_unit</span>                         <span class="n">Ry</span>  
    <span class="n">rR_unit</span>                         <span class="n">Bohr</span>
<span class="p">}</span>

<span class="n">LATTICE</span>
<span class="p">{</span>
    <span class="n">lattice_constant</span>                <span class="mf">1.8897162</span>
    <span class="n">lattice_constant_unit</span>           <span class="n">Bohr</span>
    <span class="n">lattice_vector</span>
    <span class="mf">7.13366</span> <span class="mi">0</span> <span class="mi">0</span> <span class="c1">#latvec1</span>
    <span class="mi">0</span> <span class="mf">7.13366</span> <span class="mi">0</span> <span class="c1">#latvec2</span>
    <span class="mi">0</span> <span class="mi">0</span> <span class="mf">7.13366</span> <span class="c1">#latvec3</span>
<span class="p">}</span>

<span class="n">BANDUNFOLDING</span>
<span class="p">{</span>
    <span class="n">stru_file</span>                       <span class="n">STRU</span>
    <span class="n">ecut</span>                            <span class="mi">60</span>
    <span class="n">band_range</span>                      <span class="mi">10</span> <span class="mi">250</span>
    <span class="n">m_matrix</span>                        <span class="o">-</span><span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="o">-</span><span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span> <span class="o">-</span><span class="mi">2</span>
    <span class="n">kpoint_mode</span>                     <span class="n">line</span>
    <span class="n">kpoint_num</span>                      <span class="mi">5</span>
    <span class="n">high_symmetry_kpoint</span>
    <span class="mf">0.500000</span>  <span class="mf">0.000000</span>  <span class="mf">0.500000</span> <span class="mi">300</span>  <span class="c1"># X</span>
    <span class="mf">0.500000</span>  <span class="mf">0.250000</span>  <span class="mf">0.750000</span> <span class="mi">300</span>  <span class="c1"># W</span>
    <span class="mf">0.500000</span>  <span class="mf">0.500000</span>  <span class="mf">0.500000</span> <span class="mi">300</span>  <span class="c1"># L</span>
    <span class="mf">0.000000</span>  <span class="mf">0.000000</span>  <span class="mf">0.000000</span> <span class="mi">300</span>  <span class="c1"># Gamma</span>
    <span class="mf">0.500000</span>  <span class="mf">0.000000</span>  <span class="mf">0.500000</span> <span class="mi">1</span>    <span class="c1"># X</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">stru_file</span></code>: The structure file name of the supercell. This file indicates the crystal structure of the supercell and the corresponding orbital file. Make sure that both the structure file and the orbital file exist.</p>
<p><code class="docutils literal notranslate"><span class="pre">ecut</span></code>: Determine the number of projections to the plane wave basis group, the energy unit is Ry.</p>
<p><code class="docutils literal notranslate"><span class="pre">band_range</span></code>: Specify the energy band range of band unfolding.</p>
<p><code class="docutils literal notranslate"><span class="pre">m_matrix</span></code>: Transformation matrix of supercell and primitive cell lattice vector</p>
<p>The k-point setting is determined according to the structure of the original cell, not the k-point in the supercell. For the k point setting of this function, please refer to the <code class="docutils literal notranslate"><span class="pre">kpoint_mode</span></code> module.</p>
<p>Once the task calculation is finished, three files will be generated in the <code class="docutils literal notranslate"><span class="pre">Out/Bandunfolding</span></code> folder. These files include <code class="docutils literal notranslate"><span class="pre">kpt.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">spectral_weight.dat</span></code>, representing the k-point and spectral function of the original cell, respectively. Additionally, a drawing script called <code class="docutils literal notranslate"><span class="pre">plot_unfold.py</span></code> will also be included.</p>
<p><strong>NOTE</strong>: When calculating a slab material, it is necessary to remove the thickness of the vacuum layer and make necessary modifications to the crystal vector and atomic positions specified in the <code class="docutils literal notranslate"><span class="pre">LATTICE</span></code> and structure files. Failing to make these modifications accurately can result in inaccurate results.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="band_structure.html" class="btn btn-neutral float-left" title="BAND_STRUCTURE" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fermi_energy.html" class="btn btn-neutral float-right" title="FERMI_ENERGY" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, PYATB.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>